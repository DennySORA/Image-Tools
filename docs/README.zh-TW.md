[English](../README.md) | [繁體中文](README.zh-TW.md) | [简体中文](README.zh-CN.md) | [日本語](README.ja.md)

# Image-Tools

一套全面的、生產級的圖像處理工具套件，採用最先進的 AI 技術。提供專業級背景移除、浮水印移除和智能圖像分割功能，完全本地運算，保護您的隱私。

## ✨ 主要功能

### 🎯 背景移除
- **Ultra 後端** - 使用 BRIA RMBG-2.0 達到最高品質（非商業用途）
- **Unified 後端** - 使用 BiRefNet-massive 適合商業用途（MIT 授權）
- **進階處理** - Trimap 精細化、多色彩空間去邊
- **色彩優化** - 針對綠色/白色/黑色背景的特殊處理
- **可控強度** - 精細調整移除強度（0.1-1.0）

### 🌊 浮水印移除
- **Gemini 浮水印移除器** - 移除 Google Gemini AI 生成的浮水印
- **反向 Alpha 混合** - 數學精確移除
- **自動偵測** - 自動偵測浮水印大小（48px/96px）
- **可調強度** - 部分或完全移除

### ✂️ 圖像分割
- **智能網格佈局** - 自動計算最佳網格配置
- **自訂排列** - 靈活的行×列配置
- **品質保留** - 無壓縮、無損分割
- **批次處理** - 一次分割多張圖片

## 🚀 快速開始

### 安裝

需求：Python 3.13+ 和 `uv` 套件管理器

```bash
git clone https://github.com/yourusername/Image-Tools.git
cd Image-Tools
uv sync
```

### 執行

```bash
uv run main.py
```

依照互動式提示操作：
1. **選擇資料夾** - 選擇輸入目錄
2. **選擇操作** - 背景移除、浮水印移除或圖像分割
3. **配置設定** - 根據您的需求調整參數
4. **處理** - 讓工具處理剩下的工作

輸出檔案將保存在 `<輸入資料夾>/output/`

## 📚 功能深入介紹

### 背景移除

#### 應該使用哪個後端？

| 後端 | 品質 | 速度 | 授權 | 最適合 |
|---------|---------|-------|---------|----------|
| **Ultra** ⭐⭐⭐⭐⭐ | 極致 | 中等 | **非商業用途** | 個人專案、最高品質 |
| **Unified** ⭐⭐⭐⭐ | 優秀 | 快速 | **MIT（商業可用）** | 商業專案、生產環境 |

#### Ultra 後端（最高品質）

**⚠️ 僅供非商業使用（CC BY-NC 4.0）**

為追求絕對最佳品質的個人用戶提供的終極解決方案：

**功能：**
- **BRIA RMBG-2.0** - 具有優秀訓練數據的專業級模型
- **Trimap 精細化** - 智能邊界處理（保留細節）
- **多色彩空間去邊** - RGB + LAB + HSV 色彩分析
- **導向濾波器** - 邊緣感知平滑（優於高斯模糊）
- **色彩過濾器** - 針對純色背景優化

#### Unified 後端（適合商業用途）

**✅ MIT 授權 - 商業使用許可**

結合品質與靈活性的平衡解決方案：

**功能：**
- **BiRefNet-massive** - SOTA 分割與優秀的邊緣保留
- **Alpha Matting** - 自動精細化複雜邊緣
- **邊緣去污染** - 移除色彩污染
- **色彩過濾器** - 純色背景優化

#### 建議設定

| 場景 | 強度 | 色彩過濾器 |
|----------|----------|--------------|
| 一般照片 | 0.5-0.7 | 關閉 |
| 複雜邊緣（頭髮/毛髮） | 0.6-0.8 | 關閉 |
| 綠幕 | 0.7-0.9 | 綠色 |
| 白色背景（產品） | 0.7-0.9 | 白色 |
| 黑色背景（工作室） | 0.7-0.9 | 黑色 |

### 浮水印移除

使用反向 Alpha 混合演算法移除 Google Gemini AI 浮水印。

**功能：**
- **自動偵測** - 根據圖像尺寸自動偵測浮水印大小
- **手動覆蓋** - 如需要可強制使用 48px 或 96px 模式
- **強度控制** - 調整移除強度（0.1-1.0）
- **精確演算法** - 數學反向 Alpha 混合

**偵測規則：**
- 圖像 > 1024×1024 像素 → 96×96 浮水印
- 圖像 ≤ 1024×1024 像素 → 48×48 浮水印

### 圖像分割

將大型圖像分割成較小的圖塊，具有智能佈局。

**功能：**
- **智能網格** - 自動計算最佳行×列
- **自訂佈局** - 指定精確的網格配置
- **品質保留** - 無損 PNG 輸出
- **批次處理** - 處理多張圖像

**使用案例：**
- 社交媒體輪播（Instagram、Twitter）
- 列印佈局和海報
- 遊戲地圖圖塊
- 大型藝術作品分割

## 🔧 技術細節

### 處理流程（背景移除）

```
輸入圖像
    ↓
階段 1: BiRefNet 分割
    ├─ 高解析度二分分割
    ├─ 動態 alpha matting（強度 ≥ 0.3 時自動啟用）
    └─ 自適應前景/背景閾值
    ↓
階段 2: 色彩過濾器（可選）
    ├─ HSV/LAB 色彩空間偵測
    ├─ 形態學遮罩精細化
    ├─ 邊緣去污染（綠幕）
    └─ Alpha 通道合併
    ↓
階段 3: 邊緣去污染
    ├─ 半透明邊緣偵測
    ├─ 色彩不平衡分析
    └─ 邊緣色彩校正
    ↓
輸出 PNG（RGBA）
```

### 效能

- **單張圖像**：2-5 秒（取決於解析度和硬體）
- **記憶體使用**：~3-4GB GPU（BiRefNet-massive）、~2GB CPU
- **批次處理**：高效的 session 重用
- **品質**：與商業服務相當或更好

### 硬體需求

| 配置 | 規格 |
|---------------|-------|
| **最低** | 8GB RAM + CPU（較慢） |
| **建議** | 16GB RAM + 4GB+ VRAM GPU（CUDA） |
| **最佳** | 32GB RAM + 8GB+ VRAM GPU |

## 🆚 比較

| 功能 | 商業工具 | **Image-Tools** |
|---------|------------------|-----------------|
| 隱私 | ❌ 需要上傳 | ✅ 100% 本地 |
| 自訂化 | ❌ 有限控制 | ✅ 完全控制 |
| 成本 | 💰 $0.20+/圖 | ✅ 免費（僅硬體） |
| 品質 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 功能 | 僅背景移除 | ✅ 多工具套件 |
| 授權 | 專有 | ✅ MIT（主要）、CC BY-NC（Ultra） |

## 📦 依賴項

所有依賴項都是開源且具有寬鬆授權：

- **rembg**（MIT）— 背景移除的 BiRefNet 模型
- **transformers**（Apache 2.0）— BRIA RMBG-2.0 的 HuggingFace transformers
- **onnxruntime**（MIT）— ONNX 模型的執行時支援
- **pillow**（HPND）— 圖像處理工具
- **opencv-python**（Apache 2.0）— 電腦視覺操作
- **InquirerPy**（MIT）— 互動式 CLI 介面
- **torch**（BSD-3）— PyTorch 深度學習框架
- **numpy**（BSD-3）— 數值運算

## 🙏 致謝

本專案建立在優秀的開源作品之上：

- **BiRefNet** by [ZhengPeng7](https://github.com/ZhengPeng7/BiRefNet) - SOTA 分割
- **BRIA RMBG-2.0** by [BRIA AI](https://huggingface.co/briaai/RMBG-2.0) - 專業級模型
- **Rembg** by [danielgatis](https://github.com/danielgatis/rembg) - 背景移除工具包
- **Gemini Watermark Remover** by [journey-ad](https://github.com/journey-ad/gemini-watermark-remover) - 浮水印移除演算法
- **Cloudflare** - 用於[評估和推薦 BiRefNet](https://blog.cloudflare.com/background-removal-with-workers-ai/)

## 📄 授權

**MIT 授權** - 詳見 [LICENSE](../LICENSE)

**完全允許且鼓勵商業使用**（Ultra 後端除外，需要非商業授權）。

### Ultra 後端授權

Ultra 後端使用的 BRIA RMBG-2.0 採用 **CC BY-NC 4.0**（非商業）授權。如果您計劃商業使用 Ultra 後端，請聯繫 BRIA AI 取得授權。

## 🌟 Star 歷史

如果您覺得這個專案有用，請考慮給它一個 star ⭐

## 🤝 貢獻

歡迎貢獻！請隨時提交 Pull Request。

## 📧 聯繫

如有問題、議題或功能請求，請在 GitHub 上開啟 issue。

---

**用 ❤️ 為開源社群製作**
